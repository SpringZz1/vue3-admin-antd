import{c as u,a as i}from"./vue-router-9b0ebc6a.js";import{g as r,b as c,u as R,a as m,E as n,N as d}from"./index-c6acfb74.js";const f=["/login","/404"];function h(o){o.beforeEach(async e=>{if(window.document.title=e.meta.title+" | Vue Admin AntdV",r()){if(e.path==="/login")return{path:"/"}}else return f.includes(e.path)?!0:{path:"/login"}})}function l(o){h(o)}const t=u({history:i("/vue3-admin-antd/"),routes:c});async function k(o){await p(),l(t),o.use(t)}async function p(){if(!r())return{path:"/login"};try{const e=R(),s=m();!s.userRole&&await s.getUserInfo(),e.generateRoutes(s.userRole).forEach(a=>{!t.hasRoute(a.name)&&t.addRoute(a),t.hasRoute(n.name)&&t.removeRoute(n.name),t.addRoute(d)})}catch(e){console.log(e)}}export{p as a,k as s};
